{% extends 'admin/base.html' %}

{# Flask-Admin 主模板覆盖 - 继承自定义的base.html #}

{% block tail_js %}
{{ super() }}
<script>
    // Flask-Admin 中文汉化
    $(document).ready(function() {
        function translateFlaskAdmin() {
            var translations = {
                // 导航和按钮
                'List': '列表',
                'Create': '新建',
                'Add Filter': '添加筛选',
                'With selected': '批量操作',
                'Search': '搜索',
                'Apply': '应用',
                'Reset': '重置',
                'Reset Filters': '重置筛选',
                'Export': '导出',
                'Edit': '编辑',
                'Delete': '删除',
                'Save': '保存',
                'Cancel': '取消',
                'Save and Add Another': '保存并继续添加',
                'Save and Continue Editing': '保存并继续编辑',
                'Record was successfully created.': '记录创建成功。',
                'Record was successfully saved.': '记录保存成功。',
                'Record was successfully deleted.': '记录删除成功。',
                'Are you sure you want to delete this record?': '确定要删除此记录吗？',
                'Are you sure you want to delete selected records?': '确定要删除选中的记录吗？',
                'items': '条记录',
                'Home': '首页',
                'Yes': '是',
                'No': '否',
                'None': '无',
                'True': '是',
                'False': '否',
                // 筛选
                'equals': '等于',
                'not equal': '不等于',
                'contains': '包含',
                'not contains': '不包含',
                'empty': '为空',
                'not empty': '不为空',
                'in list': '在列表中',
                'not in list': '不在列表中',
                'greater than': '大于',
                'smaller than': '小于',
                'between': '介于',
                'not between': '不介于'
            };
            
            // 翻译按钮和链接
            $('a, button, .btn, .nav-link, .dropdown-item').each(function() {
                var $el = $(this);
                var html = $el.html();
                
                if (html) {
                    var changed = false;
                    for (var eng in translations) {
                        if (html.indexOf(eng) !== -1) {
                            html = html.split(eng).join(translations[eng]);
                            changed = true;
                        }
                    }
                    if (changed) {
                        $el.html(html);
                    }
                }
            });
            
            // 翻译下拉菜单中的 "X items"
            $('button, .btn').each(function() {
                var $el = $(this);
                var html = $el.html();
                if (html && html.match(/\d+\s*items/)) {
                    $el.html(html.replace(/(\d+)\s*items/g, '$1 条'));
                }
            });
        }
        
        // 延迟执行确保DOM加载完成
        setTimeout(translateFlaskAdmin, 50);
        setTimeout(translateFlaskAdmin, 200);
    });
</script>
{% endblock %}
